<!DOCTYPE html>
<html>
<head>
	<title>Box API Test App</title>
</head>
<body>
<h1>Box API Test App</h1>
		
			Audio File: <input type="file" name="file" class="file">
			
			<button name="submit" type="submit" class="submit">Submit File</button>

<script type="text/javascript" src="https://cdn01.boxcdn.net/js/static/select.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>

<script type="text/javascript">

// var options = {
//     clientId: 'fdf45ekhg6vamm0nbo8ul9njzdkfe3p2',
//     linkType: 'direct',
//     multiselect: 'true'
// };

// var boxSelect = new BoxSelect(options);

// // Register a success callback handler
// boxSelect.success(function(response) {
//     console.log(response);
// });
// // Register a cancel callback handler
// boxSelect.cancel(function() {
//     console.log("The user clicked cancel or closed the popup");
// });



// var uploadFile = $("#file");

// var uploadUrl = 'https://upload.box.com/api/2.0/files/content';

// var headers = {
//     Authorization: "bUuexcdNEzGqu3E1Uz59xj1hZyEhRbtS"
// };



// var form = new FormData();

// var fileBody = uploadFile;

// var blob = new Blob([fileBody], {type: 'text/xml'});

// form.append('file', blob);

// form.append('parent_id', '0');

const BaseUrl = "https://www.box.net/api/1.0/rest?action=get_ticket";

let api_key = "fdf45ekhg6vamm0nbo8ul9njzdkfe3p2";

let auth_token = "bUuexcdNEzGqu3E1Uz59xj1hZyEhRbtS";

let folder_id = "0";

function boxAPI (url, api_key) {
	$.getJSON("https://query.yahooapis.com/v1/public/yql?q=select%20*%20from%20xml%20where%20url%20%3D%20'" + url +	"%26api_key%3D" + api_key + "'&amp;format=json&amp;diagnostics=true",
			   function(response) {
			   			console.log(response)
						window.ticket = response.query.results.response.ticket;
						console.log(window.ticket)
						window.location.href = 'https://m.box.net/api/1.0/auth/' + ticket;

				}
			  );
}

function getMeAFile (token, key, folder) { 
	$.getJSON("https://query.yahooapis.com/v1/public/yql?q=select%20*%20from%20xml%20where%20url%20%3D%20'https%3A%2F%2Fwww.box.net%2Fapi%2F1.0%2Frest%3Faction%3Dget_account_tree%26auth_token%3D" + token + "%26api_key%3D" + key + "%26folder_id%3D" + folder + "%26params[]%3Donelevel%26params[]%3Dnozip'&amp;format=json&amp;diagnostics=true", 
		function(response) {
			console.log(response)
		}
	);
}




$(".submit").on("click", function (){

	

	event.preventDefault();

	console.log(BaseUrl);

	console.log(api_key);

	console.log("BLAHHAHAH");

	boxAPI(BaseUrl, "fdf45ekhg6vamm0nbo8ul9njzdkfe3p2");
	// event.preventDefault();

	getMeAFile(auth_token, api_key, folder_id);

	// console.log(uploadFile);

	// boxSelect.launchPopup();

	// var baseURL = "https://www.box.net/api/1.0/rest?action=get_ticket&api_key=fdf45ekhg6vamm0nbo8ul9njzdkfe3p2"

	// $.ajax({
	// 	url: uploadUrl,
	// 	headers: headers,
	// 	method: "POST",
	// 	processData: false,
	// 	contentType: false,
	// 	data: {
	// 		file: uploadFile,
	// 		parent_id: '0'
	// 	}
	// }).done(function (data){
	// 	console.log(data)
	// })
});
</script>

	

	
</body>
</html>